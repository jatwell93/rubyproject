<div class="containter">
<nav class="breadcrumb">
  <a class="breadcrumb-item" <%= link_to 'Home/', root_path%></a>
  <a class="breadcrumb-item" <%= link_to 'Recipe List/', recipes_path%></a>
  <span class="breadcrumb-item active">Recipe</span>
</nav>
</div>
<%= render 'shared/page_title', title: @recipe.name %>

<div class="row">
  <div class="col-md-4 pull-right center" id="user-image">
    <%= link_to gravatar_for(@recipe.user, size: 200), user_path(@recipe.user) %>
    <p>
      <h5>Brought to you by: <%= @recipe.user.username %></h5>
    </p>
  </div>
  <div class="col-md-8">

    <h3><%= @recipe.summary %></h3>
    <div class="show_recipe">
      <%= image_tag(@recipe.picture.url, id: "food-image") if @recipe.picture? %>
    </div>
    <div id="show-recipe" class="well">
     <h3>Ingredients</h3>
    <ul>
      <% @recipe.ingredients.each do |ingredient| %>
        <li>
          <%= ingredient.name %>
        </li>
      <% end %>
    </ul>
    <h3>Directions</h3>
    <ol>
      <% @recipe.directions.each do |direction| %>
        <li>
          <%= direction.step %>
        </li>
      <% end %>
    </ol>
      <% if @recipe.styles.any? %>
        <p>Styles: <%= render @recipe.styles %></p>
      <% end %>
      <% if @recipe.feeds.any? %>
        <p>Feeds: <%= render @recipe.feeds %></p>
      <% end %>
      <% if @recipe.preptimes.any? %>
        <p>Preptime: <%= render @recipe.preptimes %></p>
      <% end %>

      <p>
        <strong>Notes:</strong>
      </p>
      <%= simple_format(@recipe.description) %>
      <div class="pull-right">
        <%= link_to like_recipe_path(@recipe, like: true), method: :post do %>
          <i class="fa fa-thumbs-o-up" aria-hidden="true"></i> &nbsp <%= @recipe.thumbs_up_total %>
        <% end %> &nbsp&nbsp&nbsp&nbsp
        <%= link_to like_recipe_path(@recipe, like: false), method: :post do %>
          <i class="fa fa-thumbs-o-down" aria-hidden="true"></i> &nbsp <%= @recipe.thumbs_down_total %>
        <% end %>
      </div>
    </div>
        <% if logged_in? and (@recipe.user == current_user || current_user.admin?) %>
          <%= link_to "Edit this Recipe", edit_recipe_path(@recipe), class: "btn btn-success pull-right" %>
        <% end %> 
        <% if logged_in? and (@recipe.user == current_user || current_user.admin?) %>
          <%= link_to "[Delete Recipe]", @recipe, method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-danger pull-right"%>
        <% end %>
     <% if logged_in? %>
     
        <h3><br/>Reviews</h3>
        <% if @recipe.reviews.any? %>
          <% @recipe.reviews.each do |c| %>
          
            <div class="well">
              <div class="col-md-2 pull-left">
                <%= link_to gravatar_for(c.user, size: 100), user_path(c.user) %>
              <strong><%= c.user.username.downcase.capitalize %> </strong>
              </div>
                <p> <%= c.body %> </p>
                <i><small><%= c.updated_at.strftime("%m/%d/%Y") %></small></i>
                
                <% if c.user == current_user %>
                  <%= link_to "Delete Review", review_recipe_path(:revid => c.id), class:"btn btn-danger btn-small pull-right", method: :delete, data: { confirm: "Are you sure you want to delete this review?" }  %>
                <% end %>
            </div>
         
          <% end %>
        <% else %>
        <h5>Be the first to post a review!</h5>
        <% end %>
        
          <div class="form-group">
            <%= form_tag(review_recipe_path, :method=>'post') do %>
              <%= text_area_tag "body", nil, size:"5x5",  class:"form-control" %>
              <%= submit_tag "Submit Review", class: "btn btn-primary" %> <br/><br/>
          </div>
            <% end %>
        
      <% else %>
        <%= link_to "Login",  new_user_session_path %> or <%= link_to "register", new_user_registration_path %> to see reviews
      <% end %>
        
  </div>
</div>
  <div class="jumbotron">
  <div class="container">
    <h1>Join the discussion</h1>
    <p>Click the button below to start a new thread:</p>
    <p>
      <%= link_to 'Add new topic', new_comment_path, class: 'btn btn-primary btn-lg' %>
    </p>
  </div>
</div>
<%# @comments.inspect.to_yaml%>
<%= comments_tree_for Comment.all %>
<%# render @comments %>
<div class="test"></div>

<h5><%= link_to "Return to Recipes Listing", recipes_path, class: "btn btn-warning btn-small" %></h5>